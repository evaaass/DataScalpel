package cn.superhuang.data.scalpel.admin.spark;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.ServerConnector;
import org.eclipse.jetty.servlet.ServletContextHandler;
import org.eclipse.jetty.servlet.ServletHolder;
import org.glassfish.jersey.server.ResourceConfig;
import org.glassfish.jersey.servlet.ServletContainer;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.QueryParam;
import javax.ws.rs.core.MediaType;

public class Main {
    private static final ResourceConfig resourceConfig = new ResourceConfig().packages("org.glassfish.jersey.server.ResourceConfig");

    public static void main(String[] args) throws Exception {
        Server server = new Server();
        ServerConnector serverConnector = new ServerConnector(server);
        serverConnector.setPort(8082);
        ServletContextHandler servletContextHandler = new ServletContextHandler();

        ServletContainer servletContainer = new ServletContainer(resourceConfig);
        server.addConnector(serverConnector);

        servletContextHandler.addServlet(new ServletHolder(servletContainer), "/*");
        server.setHandler(servletContextHandler);
        server.start();
        server.join();

    }

    @Path("/add")
    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String add(@QueryParam("x") int x, @QueryParam("y") int y) {
        return "" + (x + y);
    }
}
